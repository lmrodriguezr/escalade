/**
 *  Copyright (c) 2010 Alethia Inc,
 *  http://www.alethia-inc.com
 *  Developed by Travis Tidwell | travist at alethia-inc.com 
 *
 *  License:  GPL version 3.
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the "Software"), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 *  
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.

 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 *  THE SOFTWARE.
 */
(function(a){jQuery.media=jQuery.extend({},{sha256:function(){function b(T,S){b.charSize=8;b.b64pad="";b.hexCase=0;var Q=null;var H=null;var x=function(p){var o=[];var s=(1<<b.charSize)-1;var r=p.length*b.charSize;for(var q=0;q<r;q+=b.charSize){o[q>>5]|=(p.charCodeAt(q/b.charSize)&s)<<(32-b.charSize-q%32);}return o;};var n=function(p){var o=[];var s=p.length;for(var q=0;q<s;q+=2){var r=parseInt(p.substr(q,2),16);if(!isNaN(r)){o[q>>3]|=r<<(24-(4*(q%8)));}else{return"INVALID HEX STRING";}}return o;};var l=null;var j=null;if("HEX"===S){if(0!==(T.length%2)){return"TEXT MUST BE IN BYTE INCREMENTS";}l=T.length*4;j=n(T);}else{if(("ASCII"===S)||("undefined"===typeof(S))){l=T.length*b.charSize;j=x(T);}else{return"UNKNOWN TEXT INPUT TYPE";}}var R=function(p){var o=b.hexCase?"0123456789ABCDEF":"0123456789abcdef";var s="";var r=p.length*4;for(var q=0;q<r;q++){s+=o.charAt((p[q>>2]>>((3-q%4)*8+4))&15)+o.charAt((p[q>>2]>>((3-q%4)*8))&15);}return s;};var K=function(p){var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var v="";var u=p.length*4;for(var r=0;r<u;r+=3){var s=(((p[r>>2]>>8*(3-r%4))&255)<<16)|(((p[r+1>>2]>>8*(3-(r+1)%4))&255)<<8)|((p[r+2>>2]>>8*(3-(r+2)%4))&255);for(var q=0;q<4;q++){if(r*8+q*6>p.length*32){v+=b.b64pad;}else{v+=o.charAt((s>>6*(3-q))&63);}}}return v;};var z=function(o,p){if(p<32){return(o>>>p)|(o<<(32-p));}else{return o;}};var y=function(o,p){if(p<32){return o>>>p;}else{return 0;}};var t=function(o,q,p){return(o&q)^(~o&p);};var m=function(o,q,p){return(o&q)^(o&p)^(q&p);};var k=function(o){return z(o,2)^z(o,13)^z(o,22);};var i=function(o){return z(o,6)^z(o,11)^z(o,25);};var h=function(o){return z(o,7)^z(o,18)^y(o,3);};var g=function(o){return z(o,17)^z(o,19)^y(o,10);};var f=function(p,r){var q=(p&65535)+(r&65535);var o=(p>>>16)+(r>>>16)+(q>>>16);return((o&65535)<<16)|(q&65535);};var e=function(p,o,u,s){var r=(p&65535)+(o&65535)+(u&65535)+(s&65535);var q=(p>>>16)+(o>>>16)+(u>>>16)+(s>>>16)+(r>>>16);return((q&65535)<<16)|(r&65535);};var d=function(p,o,v,u,s){var r=(p&65535)+(o&65535)+(v&65535)+(u&65535)+(s&65535);var q=(p>>>16)+(o>>>16)+(v>>>16)+(u>>>16)+(s>>>16)+(r>>>16);return((q&65535)<<16)|(r&65535);};var c=function(B,A,w){var o=[];var M,L,J,I,G,F,E,D;var v,s;var q;var p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];if(w==="SHA-224"){q=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428];}else{q=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];}B[A>>5]|=128<<(24-A%32);B[((A+1+64>>9)<<4)+15]=A;var u=B.length;for(var C=0;C<u;C+=16){M=q[0];L=q[1];J=q[2];I=q[3];G=q[4];F=q[5];E=q[6];D=q[7];for(var r=0;r<64;r++){if(r<16){o[r]=B[r+C];}else{o[r]=e(g(o[r-2]),o[r-7],h(o[r-15]),o[r-16]);}v=d(D,i(G),t(G,F,E),p[r],o[r]);s=f(k(M),m(M,L,J));D=E;E=F;F=G;G=f(I,v);I=J;J=L;L=M;M=f(v,s);}q[0]=f(M,q[0]);q[1]=f(L,q[1]);q[2]=f(J,q[2]);q[3]=f(I,q[3]);q[4]=f(G,q[4]);q[5]=f(F,q[5]);q[6]=f(E,q[6]);q[7]=f(D,q[7]);}switch(w){case"SHA-224":return[q[0],q[1],q[2],q[3],q[4],q[5],q[6]];case"SHA-256":return q;default:return[];}};this.getHash=function(p,o){var r=null;var q=j.slice();switch(o){case"HEX":r=R;break;case"B64":r=K;break;default:return"FORMAT NOT RECOGNIZED";}switch(p){case"SHA-224":if(Q===null){Q=c(q,l,p);}return r(Q);case"SHA-256":if(H===null){H=c(q,l,p);}return r(H);default:return"HASH NOT RECOGNIZED";}};this.getHMAC=function(D,C,B,A){var w=null;var v=null;var u=[];var s=[];var q=null;var p=null;var o=null;switch(A){case"HEX":w=R;break;case"B64":w=K;break;default:return"FORMAT NOT RECOGNIZED";}switch(B){case"SHA-224":o=224;break;case"SHA-256":o=256;break;default:return"HASH NOT RECOGNIZED";}if("HEX"===C){if(0!==(D.length%2)){return"KEY MUST BE IN BYTE INCREMENTS";}v=n(D);p=D.length*4;}else{if("ASCII"===C){v=x(D);p=D.length*b.charSize;}else{return"UNKNOWN KEY INPUT TYPE";}}if(512<p){v=c(v,p,B);v[15]&=4294967040;}else{if(512>p){v[15]&=4294967040;}}for(var r=0;r<=15;r++){u[r]=v[r]^909522486;s[r]=v[r]^1549556828;}q=c(u.concat(j),512+l,B);q=c(s.concat(q),512+o,B);return(w(q));};}this.encrypt=function(e,c){var d=new b(c,"ASCII");return d.getHMAC(e,"ASCII","SHA-256","HEX");};}},jQuery.media);})(jQuery);